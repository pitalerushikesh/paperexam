<!doctype html>
<html>
  <head>
    <title>Excalidraw Embed</title>
    <script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@excalidraw/excalidraw/dist/excalidraw.production.min.js"></script>
    <style>
      body,
      html,
      #root {
        margin: 0;
        padding: 0;
        height: 100vh;
        width: 100vw;
        overflow: hidden !important;
        touch-action: none !important;
      }

      .excalidraw {
        background-color: #ffffff !important;
        background-image:
          linear-gradient(
            90deg,
            transparent 65px,
            #ffadad 65px,
            #ffadad 67px,
            transparent 67px
          ),
          linear-gradient(#d1e5f0 1px, transparent 1px) !important;
        background-size:
          100% 100%,
          100% 32px !important;
        background-position:
          0 0,
          0 40px !important;
        background-repeat: no-repeat, repeat !important;
      }

      .excalidraw .sidebar-trigger {
        display: none !important;
      }
    </style>
    <style>
      /* 1. Transform the Top Bar into a clean Header */
      .excalidraw .App-toolbar-container {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        padding-right: 15px !important;
        width: 100% !important;
        height: 52px !important;
        background: #f1f3f5 !important; /* Grey header background */
        border-bottom: 1px solid #ced4da !important;
        display: flex !important;
        justify-content: center !important;
        align-items: center !important;
        z-index: 100 !important;
      }

      /* 2. Remove the "Floating" side tools (Lock and Hand icons on the right) */
      /* These are the icons visible in your uploaded image_b5ce1c.png */
      .excalidraw .App-menu__right,
      .excalidraw .layer-ui__sidebars,
      .excalidraw .main-menu-trigger,
      [data-testid="toolbar-hand"],
      [data-testid="toolbar-lock"] {
        display: none !important;
      }

      /* 3. Push the 'Answer Sheet' text down so it's not hidden behind the bar */
      .excalidraw .layer-ui__wrapper {
        margin-top: 52px !important;
      }

      /* 4. Adjust your notebook paper lines to start exactly under the header */
      .excalidraw {
        background-position:
          0 52px,
          0 84px !important;
      }

      /* 5. Keep the hamburger menu hidden */
      .excalidraw .App-menu__left {
        display: none !important;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script>
      window.process = { env: { NODE_ENV: "production" } };
      let apiReference = null;

      // Hard block for wheel events (prevents both zoom and scroll)
      window.addEventListener(
        "wheel",
        (e) => {
          e.preventDefault();
          e.stopPropagation();
        },
        { capture: true, passive: false },
      );

      function init() {
        const root = ReactDOM.createRoot(document.getElementById("root"));
        const Excalidraw = window.ExcalidrawLib.Excalidraw;

        const App = () => {
          return React.createElement(Excalidraw, {
            excalidrawRef: (api) => {
              apiReference = api;
            },
            onChange: (elements, state) => {
              // THE SNAP-BACK LOGIC
              // If the user tries to pan or scroll, force it back to (0,0)
              if (
                apiReference &&
                (state.scrollX !== 0 ||
                  state.scrollY !== 0 ||
                  state.zoom.value !== 1)
              ) {
                apiReference.updateScene({
                  appState: {
                    scrollX: 0,
                    scrollY: 0,
                    zoom: { value: 1 },
                  },
                });
              }

              const payload = JSON.parse(JSON.stringify(elements));
              window.parent.postMessage(
                { type: "DRAWING_UPDATE", payload },
                "*",
              );
            },
            zenModeEnabled: false,
            gridModeEnabled: false,
            initialData: {
              appState: {
                activeTool: { type: "freedraw" },
                viewBackgroundColor: "transparent",
                zoom: { value: 1 },
                scrollX: 0,
                scrollY: 0,
                allowPanning: false, // Disables right-click drag
                scrollToContent: false,
              },
            },
          });
        };
        root.render(React.createElement(App));
      }

      const timer = setInterval(() => {
        if (window.ExcalidrawLib) {
          clearInterval(timer);
          init();
        }
      }, 100);
    </script>
    <!-- <script>
      const observer = new MutationObserver(() => {
        // 1. Find all buttons that might be the Hand, Lock, or Menu
        const selectors = [
          '[data-testid="toolbar-hand"]',
          '[data-testid="toolbar-lock"]',
          '[data-testid="main-menu-trigger"]',
          '[aria-label*="Hand"]',
          '[aria-label*="Lock"]',
          '[aria-label*="Main menu"]',
        ];

        selectors.forEach((selector) => {
          const elements = document.querySelectorAll(selector);
          elements.forEach((el) => el.remove());
        });

        // 2. Hide the side containers if they still exist
        const sidebars = document.querySelectorAll(
          ".App-menu__left, .App-menu__right, .footer-center",
        );
        sidebars.forEach((s) => (s.style.display = "none"));
      });

      // Start watching the document for when Excalidraw finishes loading
      observer.observe(document.body, {
        childList: true,
        subtree: true,
      });
    </script> -->
  </body>
</html>
